{"ast":null,"code":"import _regeneratorRuntime from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faTrash,faPencilAlt}from\"@fortawesome/free-solid-svg-icons\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Nweet=function Nweet(_ref){var nweetObj=_ref.nweetObj,isOwner=_ref.isOwner,setNweets=_ref.setNweets,nweets=_ref.nweets;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editMode=_useState2[0],setEditmode=_useState2[1];var _useState3=useState(nweetObj.body),_useState4=_slicedToArray(_useState3,2),newNweet=_useState4[0],setNewNweet=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var onEditToggle=function onEditToggle(){setEditmode(function(prev){return!prev;});};var onChange=function onChange(e){var value=e.target.value;setNewNweet(value);};// 게시글 수정(POST:post/id)\nvar onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,result,restNweets;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"수정\");// 서버에 postID와 수정데이터를 전달\n// await axios.post(`/post/${nweetObj.id}`, newNweet);\nif(!(!newNweet||!newNweet.trim())){_context.next=3;break;}return _context.abrupt(\"return\",alert(\"게시글을 입력하세요\"));case 3:data={id:nweetObj._id,body:newNweet};_context.prev=4;setLoading(true);_context.next=8;return axios.post(\"/post/update\",data);case 8:result=_context.sent;console.log(result.data);restNweets=nweets.filter(function(v){return v._id!==nweetObj._id;});setNweets([result.data.updatedPost].concat(_toConsumableArray(restNweets)));_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](4);setError(_context.t0);case 17:setLoading(false);setNewNweet(\"\");setEditmode(false);case 20:case\"end\":return _context.stop();}}},_callee,null,[[4,14]]);}));return function onSubmit(){return _ref2.apply(this,arguments);};}();// 게시글 삭제(DELETE:post/id)\nvar onDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"삭제\");// 서버에 postID를 전달\n_context2.prev=1;setLoading(true);_context2.next=5;return axios.delete(\"/post/\".concat(nweetObj._id));case 5:result=_context2.sent;if(result.data.message===\"삭제완료\"){setNweets(nweets.filter(function(v){return v._id!==nweetObj._id;}));}_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);setError(_context2.t0);case 12:setLoading(false);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function onDelete(){return _ref3.apply(this,arguments);};}();if(loading)return/*#__PURE__*/_jsxs(\"div\",{className:\"loadingBox\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dim\"}),/*#__PURE__*/_jsx(\"div\",{className:\"circle\"})]});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"statusBar\",children:\"Error!\"});return/*#__PURE__*/_jsx(\"div\",{className:\"nweet\",children:editMode?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"container nweetEdit\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Edit your nweet\",value:newNweet,required:true,autoFocus:true,onChange:onChange,className:\"formInput\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Update Nweet\",className:\"formBtn\"})]}),/*#__PURE__*/_jsx(\"span\",{onClick:onEditToggle,className:\"formBtn cancelBtn\",children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"nweet_body\",children:nweetObj.body}),isOwner&&/*#__PURE__*/_jsxs(\"div\",{class:\"nweet__actions\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:onDelete,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTrash})}),/*#__PURE__*/_jsx(\"span\",{onClick:onEditToggle,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faPencilAlt})})]})]})});};export default Nweet;","map":{"version":3,"sources":["/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/src/components/Nweet.js"],"names":["React","useState","FontAwesomeIcon","faTrash","faPencilAlt","axios","Nweet","nweetObj","isOwner","setNweets","nweets","editMode","setEditmode","body","newNweet","setNewNweet","loading","setLoading","error","setError","onEditToggle","prev","onChange","e","value","target","onSubmit","console","log","trim","alert","data","id","_id","post","result","restNweets","filter","v","updatedPost","onDelete","delete","message"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTrash, faPencilAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport axios from \"axios\";\n\nconst Nweet = ({ nweetObj, isOwner, setNweets, nweets }) => {\n  const [editMode, setEditmode] = useState(false);\n  const [newNweet, setNewNweet] = useState(nweetObj.body);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const onEditToggle = () => {\n    setEditmode((prev) => !prev);\n  };\n\n  const onChange = (e) => {\n    const { value } = e.target;\n    setNewNweet(value);\n  };\n\n  // 게시글 수정(POST:post/id)\n  const onSubmit = async () => {\n    console.log(\"수정\");\n    // 서버에 postID와 수정데이터를 전달\n    // await axios.post(`/post/${nweetObj.id}`, newNweet);\n    if (!newNweet || !newNweet.trim()) {\n      return alert(\"게시글을 입력하세요\");\n    }\n    const data = { id: nweetObj._id, body: newNweet };\n    try {\n      setLoading(true);\n      const result = await axios.post(`/post/update`, data);\n      console.log(result.data);\n      const restNweets = nweets.filter((v) => v._id !== nweetObj._id);\n      setNweets([result.data.updatedPost, ...restNweets]);\n    } catch (e) {\n      setError(e);\n    }\n    setLoading(false);\n    setNewNweet(\"\");\n    setEditmode(false);\n  };\n\n  // 게시글 삭제(DELETE:post/id)\n  const onDelete = async () => {\n    console.log(\"삭제\");\n    // 서버에 postID를 전달\n    try {\n      setLoading(true);\n      const result = await axios.delete(`/post/${nweetObj._id}`);\n      if (result.data.message === \"삭제완료\") {\n        setNweets(nweets.filter((v) => v._id !== nweetObj._id));\n      }\n    } catch (e) {\n      setError(e);\n    }\n    setLoading(false);\n  };\n\n  if (loading)\n    return (\n      <div className=\"loadingBox\">\n        <div className=\"dim\"></div>\n        <div className=\"circle\"></div>\n      </div>\n    );\n  if (error) return <div className=\"statusBar\">Error!</div>;\n\n  return (\n    <div className=\"nweet\">\n      {editMode ? (\n        <>\n          <form onSubmit={onSubmit} className=\"container nweetEdit\">\n            <input\n              type=\"text\"\n              placeholder=\"Edit your nweet\"\n              value={newNweet}\n              required\n              autoFocus\n              onChange={onChange}\n              className=\"formInput\"\n            />\n            <input type=\"submit\" value=\"Update Nweet\" className=\"formBtn\" />\n          </form>\n          <span onClick={onEditToggle} className=\"formBtn cancelBtn\">\n            Cancel\n          </span>\n        </>\n      ) : (\n        <>\n          {/* <div className=\"nweet_title\">{nweetObj.title}</div> */}\n          <div className=\"nweet_body\">{nweetObj.body}</div>\n          {isOwner && (\n            <div class=\"nweet__actions\">\n              <span onClick={onDelete}>\n                <FontAwesomeIcon icon={faTrash} />\n              </span>\n              <span onClick={onEditToggle}>\n                <FontAwesomeIcon icon={faPencilAlt} />\n              </span>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default Nweet;\n"]},"metadata":{},"sourceType":"module"}