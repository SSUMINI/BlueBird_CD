{"ast":null,"code":"import _regeneratorRuntime from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faTwitter,faGoogle,faGithub}from\"@fortawesome/free-brands-svg-icons\";import axios from\"axios\";import{setCookie}from\"../cookies\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Auth=function Auth(_ref){var setUserObj=_ref.setUserObj;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),newAccount=_useState6[0],setNewAccount=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var onChange=function onChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;if(name===\"username\"){setUsername(value);}else if(name===\"password\"){setPassword(value);}};var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data,res,_res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();data={username:username,password:password};if(!newAccount){_context.next=18;break;}console.log(\"회원가입\");_context.prev=4;setLoading(true);_context.next=8;return axios.post(\"user/join\",data);case 8:res=_context.sent;// 가입정보 서버송신 > db저장 > 유저객체 복원 > 프론트 수신(res)\nsetUserObj(res.data);// 유저상태 업데이트\n_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](4);_context.t0.response&&setError(_context.t0.response.data);case 15:setLoading(false);_context.next=32;break;case 18:console.log(\"로그인\");_context.prev=19;setLoading(true);_context.next=23;return axios.post(\"/user/login\",data);case 23:_res=_context.sent;// 로그인정보 서버송신 > db조회 > 유저객체 복원 > 프론트 수신(res)\nsetCookie(\"myToken\",_res.data.token);setUserObj(_res.data.user);// 유저상태 업데이트\n_context.next=31;break;case 28:_context.prev=28;_context.t1=_context[\"catch\"](19);_context.t1.response&&setError(_context.t1.response.data);case 31:setLoading(false);case 32:case\"end\":return _context.stop();}}},_callee,null,[[4,12],[19,28]]);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();var toggleAccount=function toggleAccount(){return setNewAccount(function(prev){return!prev;});};var SocialLogin=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"/auth/google/callback\");case 2:res=_context2.sent;console.log(res.data);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function SocialLogin(_x2){return _ref3.apply(this,arguments);};}();if(loading)return/*#__PURE__*/_jsxs(\"div\",{className:\"loadingBox\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dim\"}),/*#__PURE__*/_jsx(\"div\",{className:\"circle\"})]});//   if (error) return <div className=\"statusBar\">Error!</div>;\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"authContainer\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTwitter,color:\"#04AAFF\",size:\"3x\",style:{marginBottom:30}}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",placeholder:\"Username\",required:true,value:username,onChange:onChange,className:\"authInput\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",placeholder:\"Passoword\",required:true,value:password,onChange:onChange,className:\"authInput\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"errMsg\",children:[\" \",error,\" \"]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:newAccount?\"Create Account\":\"Log In\",className:\"authInput authSubmit\"})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:toggleAccount,className:\"authSwitch\",children:[newAccount?\"Sign In\":\"Create Account\",\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"authBtns\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:SocialLogin,name:\"google\",className:\"authBtn\",children:[\"Continue with Google \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faGoogle})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:SocialLogin,name:\"github\",className:\"authBtn\",children:[\"Continue with Github \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faGithub})]})]})]});};export default Auth;","map":{"version":3,"sources":["/home/jenkins/agent/workspace/react-front-build_CI/bluebird_ci/src/routes/Auth.js"],"names":["React","useState","FontAwesomeIcon","faTwitter","faGoogle","faGithub","axios","setCookie","Auth","setUserObj","username","setUsername","password","setPassword","newAccount","setNewAccount","loading","setLoading","error","setError","onChange","event","target","name","value","onSubmit","e","preventDefault","data","console","log","post","res","response","token","user","toggleAccount","prev","SocialLogin","marginBottom"],"mappings":"4hBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,eAAT,KAAgC,gCAAhC,CACA,OACEC,SADF,CAEEC,QAFF,CAGEC,QAHF,KAIO,oCAJP,CAKA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,YAA1B,C,wFAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAoB,IAAjBC,CAAAA,UAAiB,MAAjBA,UAAiB,CAC/B,cAAgCR,QAAQ,CAAC,EAAD,CAAxC,wCAAOS,QAAP,eAAiBC,WAAjB,eACA,eAAgCV,QAAQ,CAAC,EAAD,CAAxC,yCAAOW,QAAP,eAAiBC,WAAjB,eACA,eAAoCZ,QAAQ,CAAC,IAAD,CAA5C,yCAAOa,UAAP,eAAmBC,aAAnB,eACA,eAA8Bd,QAAQ,CAAC,KAAD,CAAtC,yCAAOe,OAAP,eAAgBC,UAAhB,eACA,eAA0BhB,QAAQ,CAAC,IAAD,CAAlC,0CAAOiB,KAAP,gBAAcC,QAAd,gBAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CAC1B,kBAEIA,KAFJ,CACEC,MADF,CACYC,IADZ,eACYA,IADZ,CACkBC,KADlB,eACkBA,KADlB,CAGA,GAAID,IAAI,GAAK,UAAb,CAAyB,CACvBZ,WAAW,CAACa,KAAD,CAAX,CACD,CAFD,IAEO,IAAID,IAAI,GAAK,UAAb,CAAyB,CAC9BV,WAAW,CAACW,KAAD,CAAX,CACD,CACF,CATD,CAWA,GAAMC,CAAAA,QAAQ,2FAAG,iBAAOC,CAAP,oIACfA,CAAC,CAACC,cAAF,GACMC,IAFS,CAEF,CAAElB,QAAQ,CAARA,QAAF,CAAYE,QAAQ,CAARA,QAAZ,CAFE,KAIXE,UAJW,0BAKbe,OAAO,CAACC,GAAR,CAAY,MAAZ,EALa,gBAOXb,UAAU,CAAC,IAAD,CAAV,CAPW,sBAQOX,CAAAA,KAAK,CAACyB,IAAN,CAAW,WAAX,CAAwBH,IAAxB,CARP,QAQLI,GARK,eAQsC;AACjDvB,UAAU,CAACuB,GAAG,CAACJ,IAAL,CAAV,CAAsB;AATX,iFAWX,YAAIK,QAAJ,EAAgBd,QAAQ,CAAC,YAAIc,QAAJ,CAAaL,IAAd,CAAxB,CAXW,QAabX,UAAU,CAAC,KAAD,CAAV,CAba,+BAebY,OAAO,CAACC,GAAR,CAAY,KAAZ,EAfa,iBAiBXb,UAAU,CAAC,IAAD,CAAV,CAjBW,uBAkBOX,CAAAA,KAAK,CAACyB,IAAN,CAAW,aAAX,CAA0BH,IAA1B,CAlBP,SAkBLI,IAlBK,eAkBwC;AACnDzB,SAAS,CAAC,SAAD,CAAYyB,IAAG,CAACJ,IAAJ,CAASM,KAArB,CAAT,CACAzB,UAAU,CAACuB,IAAG,CAACJ,IAAJ,CAASO,IAAV,CAAV,CAA2B;AApBhB,kFAsBX,YAAIF,QAAJ,EAAgBd,QAAQ,CAAC,YAAIc,QAAJ,CAAaL,IAAd,CAAxB,CAtBW,QAwBbX,UAAU,CAAC,KAAD,CAAV,CAxBa,6EAAH,kBAARQ,CAAAA,QAAQ,6CAAd,CA4BA,GAAMW,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,SAAMrB,CAAAA,aAAa,CAAC,SAACsB,IAAD,QAAU,CAACA,IAAX,EAAD,CAAnB,EAAtB,CAEA,GAAMC,CAAAA,WAAW,2FAAG,kBAAOZ,CAAP,qJACApB,CAAAA,KAAK,CAACyB,IAAN,CAAW,uBAAX,CADA,QACZC,GADY,gBAElBH,OAAO,CAACC,GAAR,CAAYE,GAAG,CAACJ,IAAhB,EAFkB,wDAAH,kBAAXU,CAAAA,WAAW,8CAAjB,CAKA,GAAItB,OAAJ,CACE,mBACE,aAAK,SAAS,CAAC,YAAf,wBACE,YAAK,SAAS,CAAC,KAAf,EADF,cAEE,YAAK,SAAS,CAAC,QAAf,EAFF,GADF,CAMF;AAEA,mBACE,aAAK,SAAS,CAAC,eAAf,wBACE,KAAC,eAAD,EACE,IAAI,CAAEb,SADR,CAEE,KAAK,CAAE,SAFT,CAGE,IAAI,CAAC,IAHP,CAIE,KAAK,CAAE,CAAEoC,YAAY,CAAE,EAAhB,CAJT,EADF,cAOE,cAAM,QAAQ,CAAEd,QAAhB,CAA0B,SAAS,CAAC,WAApC,wBACE,cACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,UAFP,CAGE,WAAW,CAAC,UAHd,CAIE,QAAQ,KAJV,CAKE,KAAK,CAAEf,QALT,CAME,QAAQ,CAAEU,QANZ,CAOE,SAAS,CAAC,WAPZ,EADF,cAUE,cACE,IAAI,CAAC,UADP,CAEE,IAAI,CAAC,UAFP,CAGE,WAAW,CAAC,WAHd,CAIE,QAAQ,KAJV,CAKE,KAAK,CAAER,QALT,CAME,QAAQ,CAAEQ,QANZ,CAOE,SAAS,CAAC,WAPZ,EAVF,cAmBE,cAAM,SAAS,CAAC,QAAhB,eAA2BF,KAA3B,OAnBF,cAoBE,cACE,IAAI,CAAC,QADP,CAEE,KAAK,CAAEJ,UAAU,CAAG,gBAAH,CAAsB,QAFzC,CAGE,SAAS,CAAC,sBAHZ,EApBF,GAPF,cAiCE,cAAM,OAAO,CAAEsB,aAAf,CAA8B,SAAS,CAAC,YAAxC,WACGtB,UAAU,CAAG,SAAH,CAAe,gBAD5B,CAC8C,GAD9C,GAjCF,cAoCE,aAAK,SAAS,CAAC,UAAf,wBACE,gBAAQ,OAAO,CAAEwB,WAAjB,CAA8B,IAAI,CAAC,QAAnC,CAA4C,SAAS,CAAC,SAAtD,gDACuB,KAAC,eAAD,EAAiB,IAAI,CAAElC,QAAvB,EADvB,GADF,cAIE,gBAAQ,OAAO,CAAEkC,WAAjB,CAA8B,IAAI,CAAC,QAAnC,CAA4C,SAAS,CAAC,SAAtD,gDACuB,KAAC,eAAD,EAAiB,IAAI,CAAEjC,QAAvB,EADvB,GAJF,GApCF,GADF,CA+CD,CA7GD,CA+GA,cAAeG,CAAAA,IAAf","sourcesContent":["import React, { useState } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faTwitter,\n  faGoogle,\n  faGithub,\n} from \"@fortawesome/free-brands-svg-icons\";\nimport axios from \"axios\";\nimport { setCookie } from \"../cookies\";\n\nconst Auth = ({ setUserObj }) => {\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [newAccount, setNewAccount] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const onChange = (event) => {\n    const {\n      target: { name, value },\n    } = event;\n    if (name === \"username\") {\n      setUsername(value);\n    } else if (name === \"password\") {\n      setPassword(value);\n    }\n  };\n\n  const onSubmit = async (e) => {\n    e.preventDefault();\n    const data = { username, password };\n\n    if (newAccount) {\n      console.log(\"회원가입\");\n      try {\n        setLoading(true);\n        const res = await axios.post(\"user/join\", data); // 가입정보 서버송신 > db저장 > 유저객체 복원 > 프론트 수신(res)\n        setUserObj(res.data); // 유저상태 업데이트\n      } catch (err) {\n        err.response && setError(err.response.data);\n      }\n      setLoading(false);\n    } else {\n      console.log(\"로그인\");\n      try {\n        setLoading(true);\n        const res = await axios.post(\"/user/login\", data); // 로그인정보 서버송신 > db조회 > 유저객체 복원 > 프론트 수신(res)\n        setCookie(\"myToken\", res.data.token);\n        setUserObj(res.data.user); // 유저상태 업데이트\n      } catch (err) {\n        err.response && setError(err.response.data);\n      }\n      setLoading(false);\n    }\n  };\n\n  const toggleAccount = () => setNewAccount((prev) => !prev);\n\n  const SocialLogin = async (e) => {\n    const res = await axios.post(\"/auth/google/callback\");\n    console.log(res.data);\n  };\n\n  if (loading)\n    return (\n      <div className=\"loadingBox\">\n        <div className=\"dim\"></div>\n        <div className=\"circle\"></div>\n      </div>\n    );\n  //   if (error) return <div className=\"statusBar\">Error!</div>;\n\n  return (\n    <div className=\"authContainer\">\n      <FontAwesomeIcon\n        icon={faTwitter}\n        color={\"#04AAFF\"}\n        size=\"3x\"\n        style={{ marginBottom: 30 }}\n      />\n      <form onSubmit={onSubmit} className=\"container\">\n        <input\n          type=\"text\"\n          name=\"username\"\n          placeholder=\"Username\"\n          required\n          value={username}\n          onChange={onChange}\n          className=\"authInput\"\n        />\n        <input\n          type=\"password\"\n          name=\"password\"\n          placeholder=\"Passoword\"\n          required\n          value={password}\n          onChange={onChange}\n          className=\"authInput\"\n        />\n        <span className=\"errMsg\"> {error} </span>\n        <input\n          type=\"submit\"\n          value={newAccount ? \"Create Account\" : \"Log In\"}\n          className=\"authInput authSubmit\"\n        />\n      </form>\n      <span onClick={toggleAccount} className=\"authSwitch\">\n        {newAccount ? \"Sign In\" : \"Create Account\"}{\" \"}\n      </span>\n      <div className=\"authBtns\">\n        <button onClick={SocialLogin} name=\"google\" className=\"authBtn\">\n          Continue with Google <FontAwesomeIcon icon={faGoogle} />\n        </button>\n        <button onClick={SocialLogin} name=\"github\" className=\"authBtn\">\n          Continue with Github <FontAwesomeIcon icon={faGithub} />\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}